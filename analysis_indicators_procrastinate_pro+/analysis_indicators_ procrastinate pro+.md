# –ê–Ω–∞–ª–∏–∑ –±–∏–∑–Ω–µ—Å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Procrastinate Pro+

# –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ 

–ú–Ω–µ, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–º—É –∞–Ω–∞–ª–∏—Ç–∏–∫—É —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Procrastinate Pro+, –ø–æ—Å—Ç—É–ø–∏–ª–æ —Å–ª–µ–¥—É—é—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ–≥—Ä–æ–º–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∫–ª–∞–º—É, –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤ –∫–æ–º–ø–∞–Ω–∏—è —Ç–µ—Ä–ø–∏—Ç —É–±—ã—Ç–∫–∏. –ú–æ—è –∑–∞–¥–∞—á–∞ ‚Äî —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–∏—á–∏–Ω–∞—Ö –∏ –ø–æ–º–æ—á—å –∫–æ–º–ø–∞–Ω–∏–∏ –≤—ã–π—Ç–∏ –≤ –ø–ª—é—Å. –ï—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Å 1 –º–∞—è –ø–æ 27 –æ–∫—Ç—è–±—Ä—è 2019 –≥–æ–¥–∞:

- –ª–æ–≥ —Å–µ—Ä–≤–µ—Ä–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ–± –∏—Ö –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö,
- –≤—ã–≥—Ä—É–∑–∫–∞ –∏—Ö –ø–æ–∫—É–ø–æ–∫ –∑–∞ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥,
- —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã.

# –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**–®–∞–≥ 1.** –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç—å –∏—Ö –∫ –∞–Ω–∞–ª–∏–∑—É.

–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –≤–∏–∑–∏—Ç–∞—Ö, –∑–∞–∫–∞–∑–∞—Ö –∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–∞—Ö –∏–∑ CSV-—Ñ–∞–π–ª–æ–≤ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

**–ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º**

- –≤–∏–∑–∏—Ç—ã: `/datasets/visits_info_short.csv`.¬†[–°–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç](https://code.s3.yandex.net/datasets/visits_info_short.csv);
- –∑–∞–∫–∞–∑—ã: `/datasets/orders_info_short.csv`.¬†[–°–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç](https://code.s3.yandex.net/datasets/orders_info_short.csv);
- —Ä–∞—Å—Ö–æ–¥—ã: `/datasets/costs_info_short.csv`.¬†[–°–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç](https://code.s3.yandex.net/datasets/costs_info_short.csv).

1. –ò–∑—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É. 
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –¥—É–±–ª–∏–∫–∞—Ç—ã.
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Å–µ—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö¬†—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º –≤ –Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è–º. 
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º.

**–®–∞–≥ 2.** –ù–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ LTV, ROI, —É–¥–µ—Ä–∂–∞–Ω–∏—è –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.


–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –º–µ—Ç—Ä–∏–∫ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- **get_profiles()** ‚Äî –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π,
- **get_retention()** ‚Äî –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ Retention Rate,
- **get_conversion()** ‚Äî –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏,
- **get_ltv()** ‚Äî –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ LTV.

–î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- **filter_data()** ‚Äî –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö,
- **plot_retention()** ‚Äî –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ Retention Rate,
- **plot_conversion()** ‚Äî –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏,
- **plot_ltv_roi** ‚Äî –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ LTV –∏ ROI.

**–®–∞–≥ 3.** –ü—Ä–æ–≤–µ—Å—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö.

1. –°–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—ã –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
2. –í—ã—è—Å–Ω–∏—Ç—å, –∏–∑ –∫–∞–∫–∏—Ö —Å—Ç—Ä–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞ –∫–∞–∫—É—é —Å—Ç—Ä–∞–Ω—É –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã.
3. –£–∑–Ω–∞—Ç—å, –∫–∞–∫–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—ã –∏ –∫–∞–∫–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –ø–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
4. –ò–∑—É—á–∏—Ç—å —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–Ω–∞–ª—ã, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏—à–ª–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è.

**–®–∞–≥ 4.** –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥.

1. –ü–æ—Å—á–∏—Ç–∞—Ç—å –æ–±—â—É—é —Å—É–º–º—É —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥.
2. –í—ã—è—Å–Ω–∏—Ç—å, –∫–∞–∫ —Ç—Ä–∞—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, —Ç–æ –µ—Å—Ç—å —Å–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏ –Ω–∞ –∫–∞–∂–¥—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫.
3. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–∏–Ω–∞–º–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –Ω–µ–¥–µ–ª—è–º –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É. –ó–∞—Ç–µ–º –Ω–∞ –¥—Ä—É–≥–æ–º –≥—Ä–∞—Ñ–∏–∫–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –º–µ—Å—è—Ü–∞–º –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É.
4. –£–∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —Å—Ç–æ–∏–ª–æ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (CAC) –∏–∑ –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–®–∞–≥ 5.** –û—Ü–µ–Ω–∏—Ç—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–π —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏.

–ò—Å–ø–æ–ª—å–∑—É—è –≥—Ä–∞—Ñ–∏–∫–∏ LTV, ROI –∏ CAC, –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã. –ò—Å—Å–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è 1 –Ω–æ—è–±—Ä—è 2019 –≥–æ–¥–∞, –∞ –≤ –±–∏–∑–Ω–µ—Å-–ø–ª–∞–Ω–µ –∑–∞–ª–æ–∂–µ–Ω–æ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –æ–∫—É–ø–∞—Ç—å—Å—è –Ω–µ –ø–æ–∑–¥–Ω–µ–µ —á–µ–º —á–µ—Ä–µ–∑ –¥–≤–µ –Ω–µ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–∫–ª—é—á–µ–Ω–∏—è –≤ –∞–Ω–∞–ª–∏–∑ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.

1. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã c –ø–æ–º–æ—â—å—é –≥—Ä–∞—Ñ–∏–∫–æ–≤ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–∏–Ω–∞–º–∏–∫—É –µ—ë –∏–∑–º–µ–Ω–µ–Ω–∏—è. –¢–æ –∂–µ —Å–∞–º–æ–µ —Å–¥–µ–ª–∞—Ç—å —Å —É–¥–µ—Ä–∂–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∏ –∏–∑—É—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è.
3. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.
4. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.
5. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.
6. –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Ç–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã:
    - –û–∫—É–ø–∞–µ—Ç—Å—è –ª–∏ —Ä–µ–∫–ª–∞–º–∞, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –Ω–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ü–µ–ª–æ–º?
    - –ö–∞–∫–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å—Ç—Ä–∞–Ω—ã –∏ —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –º–æ–≥—É—Ç –æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã?
    - –ß–µ–º –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏?

**–®–∞–≥ 6.** –°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º—É –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é.

1. –í—ã–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—ã –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
2. –°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–¥–µ–ª–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞.

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞–Ω–∞–ª–∏–∑—É


```python
# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

import pandas as pd
import numpy as np
from datetime import date, datetime, timedelta
from dateutil.relativedelta import relativedelta
from matplotlib import pyplot as plt
import seaborn as sns
import math
import warnings
warnings.filterwarnings('ignore')
```


```python
# –∑–∞–≥—Ä—É–∑–∏–º –∏–∑ csv-—Ñ–∞–π–ª–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω–∏–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

try:
    visits = pd.read_csv('/datasets/visits_info_short.csv')
    orders = pd.read_csv('/datasets/orders_info_short.csv')
    costs = pd.read_csv('/datasets/costs_info_short.csv')
except:
    visits = pd.read_csv('https://code.s3.yandex.net/datasets/visits_info_short.csv')
    orders = pd.read_csv('https://code.s3.yandex.net/datasets/orders_info_short.csv')
    costs = pd.read_csv('https://code.s3.yandex.net/datasets/costs_info_short.csv')
```


```python
# –≤—ã–≤–µ–¥–µ–º –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ —ç–∫—Ä–∞–Ω

visits.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>User Id</th>
      <th>Region</th>
      <th>Device</th>
      <th>Channel</th>
      <th>Session Start</th>
      <th>Session End</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>981449118918</td>
      <td>United States</td>
      <td>iPhone</td>
      <td>organic</td>
      <td>2019-05-01 02:36:01</td>
      <td>2019-05-01 02:45:01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>278965908054</td>
      <td>United States</td>
      <td>iPhone</td>
      <td>organic</td>
      <td>2019-05-01 04:46:31</td>
      <td>2019-05-01 04:47:35</td>
    </tr>
    <tr>
      <th>2</th>
      <td>590706206550</td>
      <td>United States</td>
      <td>Mac</td>
      <td>organic</td>
      <td>2019-05-01 14:09:25</td>
      <td>2019-05-01 15:32:08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>326433527971</td>
      <td>United States</td>
      <td>Android</td>
      <td>TipTop</td>
      <td>2019-05-01 00:29:59</td>
      <td>2019-05-01 00:54:25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>349773784594</td>
      <td>United States</td>
      <td>Mac</td>
      <td>organic</td>
      <td>2019-05-01 03:33:35</td>
      <td>2019-05-01 03:57:40</td>
    </tr>
  </tbody>
</table>
</div>




```python
orders.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>User Id</th>
      <th>Event Dt</th>
      <th>Revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>188246423999</td>
      <td>2019-05-01 23:09:52</td>
      <td>4.99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>174361394180</td>
      <td>2019-05-01 12:24:04</td>
      <td>4.99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>529610067795</td>
      <td>2019-05-01 11:34:04</td>
      <td>4.99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>319939546352</td>
      <td>2019-05-01 15:34:40</td>
      <td>4.99</td>
    </tr>
    <tr>
      <th>4</th>
      <td>366000285810</td>
      <td>2019-05-01 13:59:51</td>
      <td>4.99</td>
    </tr>
  </tbody>
</table>
</div>




```python
costs.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>Channel</th>
      <th>costs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-05-01</td>
      <td>FaceBoom</td>
      <td>113.3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-05-02</td>
      <td>FaceBoom</td>
      <td>78.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-05-03</td>
      <td>FaceBoom</td>
      <td>85.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-05-04</td>
      <td>FaceBoom</td>
      <td>136.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-05-05</td>
      <td>FaceBoom</td>
      <td>122.1</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ø—Ä–∏ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É

visits.columns = visits.columns.str.lower()
orders.columns = orders.columns.str.lower()
costs.columns = costs.columns.str.lower()
```


```python
# –ø–æ–º–µ–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ –Ω–∏–∂–Ω–µ–µ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ "_"

visits.columns = visits.columns.str.replace(' ', '_')
orders.columns = orders.columns.str.replace(' ', '_')
```


```python
# –≤—ã–≤–µ–¥–µ–º –æ—Å–Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö

visits.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 309901 entries, 0 to 309900
    Data columns (total 6 columns):
     #   Column         Non-Null Count   Dtype 
    ---  ------         --------------   ----- 
     0   user_id        309901 non-null  int64 
     1   region         309901 non-null  object
     2   device         309901 non-null  object
     3   channel        309901 non-null  object
     4   session_start  309901 non-null  object
     5   session_end    309901 non-null  object
    dtypes: int64(1), object(5)
    memory usage: 14.2+ MB
    


```python
orders.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 40212 entries, 0 to 40211
    Data columns (total 3 columns):
     #   Column    Non-Null Count  Dtype  
    ---  ------    --------------  -----  
     0   user_id   40212 non-null  int64  
     1   event_dt  40212 non-null  object 
     2   revenue   40212 non-null  float64
    dtypes: float64(1), int64(1), object(1)
    memory usage: 942.6+ KB
    


```python
costs.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1800 entries, 0 to 1799
    Data columns (total 3 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   dt       1800 non-null   object 
     1   channel  1800 non-null   object 
     2   costs    1800 non-null   float64
    dtypes: float64(1), object(2)
    memory usage: 42.3+ KB
    


```python
# –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã

print('\033[1m' + '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ:' + '\033[0m', visits.duplicated().sum())
```

    [1m–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ:[0m 0
    


```python
print('\033[1m' + '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ:' + '\033[0m', orders.duplicated().sum())
```

    [1m–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ:[0m 0
    


```python
print('\033[1m' + '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ:' + '\033[0m', costs.duplicated().sum())
```

    [1m–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ:[0m 0
    


```python
# –ø—Ä–æ–≤–µ–¥–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞—Ç–µ–≥—Ä–∏–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –Ω–µ—è–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
print('\033[1m' + '–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ "region":' + '\033[0m', sorted(visits['region'].unique().tolist()))
```

    [1m–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ "region":[0m ['France', 'Germany', 'UK', 'United States']
    


```python
print('\033[1m' + '–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ "device":' + '\033[0m', sorted(visits['device'].unique().tolist()))
```

    [1m–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ "device":[0m ['Android', 'Mac', 'PC', 'iPhone']
    


```python
print('\033[1m' + '–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ "channel":' + '\033[0m', sorted(visits['channel'].unique().tolist()))
```

    [1m–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ "channel":[0m ['AdNonSense', 'FaceBoom', 'LeapBob', 'MediaTornado', 'OppleCreativeMedia', 'RocketSuperAds', 'TipTop', 'WahooNetBanner', 'YRabbit', 'lambdaMediaAds', 'organic']
    


```python
# –ø–µ—Ä–µ–≤–µ–¥–µ–º —Å—Ç–æ–ª–±—Ü—ã –∫ —Ñ–∞—Ä–º–∞—Ç—É datetime

visits['session_start'] = pd.to_datetime(visits['session_start'])
visits['session_end'] = pd.to_datetime(visits['session_end'])
orders['event_dt'] = pd.to_datetime(orders['event_dt'])
costs['dt'] = pd.to_datetime(costs['dt'])
```

**–û–±—â–∏–π –≤—ã–≤–æ–¥:**

- –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏;

- –∑–∞–ø–∏—Å–∞–ª –¥–∞–Ω–Ω—ã–µ –≤ 3 –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞;

- –∏–∑–º–µ–Ω–∏–ª –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –≤—Ç–∞–±–ª–∏—Ü–∞—Ö;

- –ø—Ä–æ–≤–µ—Ä–∫–∞, –ø–æ–∫–∞–∑–∞–ª–∞ –æ—Ç—Å—É—Ç—Å–≤–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤, –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö;

- –ø—Ä–æ–≤–µ–ª –∑–∞–º–µ–Ω—É —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ datetime –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö —Å –¥–∞—Ç–∞–º–∏.

### –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ LTV, ROI, —É–¥–µ—Ä–∂–∞–Ω–∏—è –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

#### –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ LTV, ROI, —É–¥–µ—Ä–∂–∞–Ω–∏—è –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏


```python
# —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª–∑–æ–≤–∞—Ç–µ–ª–µ–π

def get_profiles(sessions, orders, ad_costs, event_names=[]):

    # –Ω–∞—Ö–æ–¥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–≤—ã—Ö –ø–æ—Å–µ—â–µ–Ω–∏–π
    profiles = (
        sessions.sort_values(by=['user_id', 'session_start'])
        .groupby('user_id')
        .agg(
            {
                'session_start': 'first',
                'channel': 'first',
                'device': 'first',
                'region': 'first',
            }
        )
        .rename(columns={'session_start': 'first_ts'})
        .reset_index()
    )

    # –¥–ª—è –∫–æ–≥–æ—Ä—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∞—Ç—É –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è
    # –∏ –ø–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π —ç—Ç–æ –ø–æ—Å–µ—â–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ
    profiles['dt'] = profiles['first_ts'].dt.date
    profiles['dt'] = pd.to_datetime(profiles['dt'], format = '%Y-%m-%d')
    profiles['month'] = profiles['first_ts']#.astype('datetime64[M]')

    # –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    profiles['payer'] = profiles['user_id'].isin(orders['user_id'].unique())


    # —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    # —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏ –¥–∞—Ç–æ–π –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è
    new_users = (
        profiles.groupby(['dt', 'channel'])
        .agg({'user_id': 'nunique'})
        .rename(columns={'user_id': 'unique_users'})
        .reset_index()
    )

    # –æ–±—ä–µ–¥–∏–Ω—è–µ–º —Ç—Ä–∞—Ç—ã –Ω–∞ —Ä–µ–∫–ª–∞–º—É –∏ —á–∏—Å–ª–æ –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    ad_costs = ad_costs.merge(new_users, on=['dt', 'channel'], how='left')

    # –¥–µ–ª–∏–º —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —á–∏—Å–ª–æ –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    ad_costs['acquisition_cost'] = ad_costs['costs'] / ad_costs['unique_users']

    # –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –≤ –ø—Ä–æ—Ñ–∏–ª–∏
    profiles = profiles.merge(
        ad_costs[['dt', 'channel', 'acquisition_cost']],
        on=['dt', 'channel'],
        how='left',
    )

    # —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ä–∞–≤–Ω–∞ –Ω—É–ª—é
    profiles['acquisition_cost'] = profiles['acquisition_cost'].fillna(0)

    return profiles
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è

def get_retention(
    profiles,
    sessions,
    observation_date,
    horizon_days,
    dimensions=[],
    ignore_horizon=False,
):

    # –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü payer –≤ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π dimensions —Å–ø–∏—Å–æ–∫
    dimensions = ['payer'] + dimensions

    # –∏—Å–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–µ ¬´–¥–æ–∂–∏–≤—à–∏—Ö¬ª –¥–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
    last_suitable_acquisition_date = observation_date
    if not ignore_horizon:
        last_suitable_acquisition_date = observation_date - timedelta(
            days=horizon_days - 1
        )
    result_raw = profiles.query('dt <= @last_suitable_acquisition_date')

    # —Å–æ–±–∏—Ä–∞–µ–º ¬´—Å—ã—Ä—ã–µ¬ª –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è
    result_raw = result_raw.merge(
        sessions[['user_id', 'session_start']], on='user_id', how='left'
    )
    result_raw['lifetime'] = (
        result_raw['session_start'] - result_raw['first_ts']
    ).dt.days

    # —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –∂–µ–ª–∞–µ–º—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º
    def group_by_dimensions(df, dims, horizon_days):
        result = df.pivot_table(
            index=dims, columns='lifetime', values='user_id', aggfunc='nunique'
        )
        cohort_sizes = (
            df.groupby(dims)
            .agg({'user_id': 'nunique'})
            .rename(columns={'user_id': 'cohort_size'})
        )
        result = cohort_sizes.merge(result, on=dims, how='left').fillna(0)
        result = result.div(result['cohort_size'], axis=0)
        result = result[['cohort_size'] + list(range(horizon_days))]
        result['cohort_size'] = cohort_sizes
        return result

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —É–¥–µ—Ä–∂–∞–Ω–∏—è
    result_grouped = group_by_dimensions(result_raw, dimensions, horizon_days)

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–∏–Ω–∞–º–∏–∫–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
    result_in_time = group_by_dimensions(
        result_raw, dimensions + ['dt'], horizon_days
    )

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
    return result_raw, result_grouped, result_in_time 
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

def get_conversion(
    profiles,
    purchases,
    observation_date,
    horizon_days,
    dimensions=[],
    ignore_horizon=False,
):

    # –∏—Å–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–µ ¬´–¥–æ–∂–∏–≤—à–∏—Ö¬ª –¥–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
    last_suitable_acquisition_date = observation_date
    if not ignore_horizon:
        last_suitable_acquisition_date = observation_date - timedelta(
            days=horizon_days - 1
        )
    result_raw = profiles.query('dt <= @last_suitable_acquisition_date')

    # –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –ø–µ—Ä–≤–æ–π –ø–æ–∫—É–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    first_purchases = (
        purchases.sort_values(by=['user_id', 'event_dt'])
        .groupby('user_id')
        .agg({'event_dt': 'first'})
        .reset_index()
    )

    # –¥–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–∫—É–ø–∫–∞—Ö –≤ –ø—Ä–æ—Ñ–∏–ª–∏
    result_raw = result_raw.merge(
        first_purchases[['user_id', 'event_dt']], on='user_id', how='left'
    )

    # —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–∞–π—Ñ—Ç–∞–π–º –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–∏
    result_raw['lifetime'] = (
        result_raw['event_dt'] - result_raw['first_ts']
    ).dt.days

    # –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ cohort, –µ—Å–ª–∏ –≤ dimensions –Ω–∏—á–µ–≥–æ –Ω–µ—Ç
    if len(dimensions) == 0:
        result_raw['cohort'] = 'All users' 
        dimensions = dimensions + ['cohort']

    # —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –∂–µ–ª–∞–µ–º—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º
    def group_by_dimensions(df, dims, horizon_days):
        result = df.pivot_table(
            index=dims, columns='lifetime', values='user_id', aggfunc='nunique'
        )
        result = result.fillna(0).cumsum(axis = 1)
        cohort_sizes = (
            df.groupby(dims)
            .agg({'user_id': 'nunique'})
            .rename(columns={'user_id': 'cohort_size'})
        )
        result = cohort_sizes.merge(result, on=dims, how='left').fillna(0)
        # –¥–µ–ª–∏–º –∫–∞–∂–¥—É—é ¬´—è—á–µ–π–∫—É¬ª –≤ —Å—Ç—Ä–æ–∫–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä –∫–æ–≥–æ—Ä—Ç—ã
        # –∏ –ø–æ–ª—É—á–∞–µ–º conversion rate
        result = result.div(result['cohort_size'], axis=0)
        result = result[['cohort_size'] + list(range(horizon_days))]
        result['cohort_size'] = cohort_sizes
        return result

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    result_grouped = group_by_dimensions(result_raw, dimensions, horizon_days)

    # –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –¥–∏–Ω–∞–º–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —É–±–∏—Ä–∞–µ–º 'cohort' –∏–∑ dimensions
    if 'cohort' in dimensions: 
        dimensions = []

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–∏–Ω–∞–º–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    result_in_time = group_by_dimensions(
        result_raw, dimensions + ['dt'], horizon_days
    )

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
    return result_raw, result_grouped, result_in_time 
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á—ë—Ç–∞ LTV –∏ ROI

def get_ltv(
    profiles,
    purchases,
    observation_date,
    horizon_days,
    dimensions=[],
    ignore_horizon=False,
):

    # –∏—Å–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–µ ¬´–¥–æ–∂–∏–≤—à–∏—Ö¬ª –¥–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
    last_suitable_acquisition_date = observation_date
    if not ignore_horizon:
        last_suitable_acquisition_date = observation_date - timedelta(
            days=horizon_days - 1
        )
    result_raw = profiles.query('dt <= @last_suitable_acquisition_date')
    # –¥–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–∫—É–ø–∫–∞—Ö –≤ –ø—Ä–æ—Ñ–∏–ª–∏
    result_raw = result_raw.merge(
        purchases[['user_id', 'event_dt', 'revenue']], on='user_id', how='left'
    )
    # —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–∞–π—Ñ—Ç–∞–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–∏
    result_raw['lifetime'] = (
        result_raw['event_dt'] - result_raw['first_ts']
    ).dt.days
    # –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ cohort, –µ—Å–ª–∏ –≤ dimensions –Ω–∏—á–µ–≥–æ –Ω–µ—Ç
    if len(dimensions) == 0:
        result_raw['cohort'] = 'All users'
        dimensions = dimensions + ['cohort']

    # —Ñ—É–Ω–∫—Ü–∏—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –∂–µ–ª–∞–µ–º—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º
    def group_by_dimensions(df, dims, horizon_days):
        # —Å—Ç—Ä–æ–∏–º ¬´—Ç—Ä–µ—É–≥–æ–ª—å–Ω—É—é¬ª —Ç–∞–±–ª–∏—Ü—É –≤—ã—Ä—É—á–∫–∏
        result = df.pivot_table(
            index=dims, columns='lifetime', values='revenue', aggfunc='sum'
        )
        # –Ω–∞—Ö–æ–¥–∏–º —Å—É–º–º—É –≤—ã—Ä—É—á–∫–∏ —Å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ–º
        result = result.fillna(0).cumsum(axis=1)
        # –≤—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
        cohort_sizes = (
            df.groupby(dims)
            .agg({'user_id': 'nunique'})
            .rename(columns={'user_id': 'cohort_size'})
        )
        # –æ–±—ä–µ–¥–∏–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –∏ —Ç–∞–±–ª–∏—Ü—É –≤—ã—Ä—É—á–∫–∏
        result = cohort_sizes.merge(result, on=dims, how='left').fillna(0)
        # —Å—á–∏—Ç–∞–µ–º LTV: –¥–µ–ª–∏–º –∫–∞–∂–¥—É—é ¬´—è—á–µ–π–∫—É¬ª –≤ —Å—Ç—Ä–æ–∫–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä –∫–æ–≥–æ—Ä—Ç—ã
        result = result.div(result['cohort_size'], axis=0)
        # –∏—Å–∫–ª—é—á–∞–µ–º –≤—Å–µ –ª–∞–π—Ñ—Ç–∞–π–º—ã, –ø—Ä–µ–≤—ã—à–∞—é—â–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞
        result = result[['cohort_size'] + list(range(horizon_days))]
        # –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
        result['cohort_size'] = cohort_sizes

        # —Å–æ–±–∏—Ä–∞–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ CAC, 
        # –¥–æ–±–∞–≤–ª—è—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ dimensions
        cac = df[['user_id', 'acquisition_cost'] + dims].drop_duplicates()

        # —Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–∏–π CAC –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∏–∑ dimensions
        cac = (
            cac.groupby(dims)
            .agg({'acquisition_cost': 'mean'})
            .rename(columns={'acquisition_cost': 'cac'})
        )

        # —Å—á–∏—Ç–∞–µ–º ROI: –¥–µ–ª–∏–º LTV –Ω–∞ CAC
        roi = result.div(cac['cac'], axis=0)

        # —É–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º ROI
        roi = roi[~roi['cohort_size'].isin([np.inf])]

        # –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ ROI
        roi['cohort_size'] = cohort_sizes

        # –¥–æ–±–∞–≤–ª—è–µ–º CAC –≤ —Ç–∞–±–ª–∏—Ü—É ROI
        roi['cac'] = cac['cac']

        # –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç, CAC
        # –∏ ROI –≤ –ª–∞–π—Ñ—Ç–∞–π–º—ã, –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—â–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞
        roi = roi[['cohort_size', 'cac'] + list(range(horizon_days))]

        # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã LTV –∏ ROI
        return result, roi

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã LTV –∏ ROI
    result_grouped, roi_grouped = group_by_dimensions(
        result_raw, dimensions, horizon_days
    )

    # –¥–ª—è —Ç–∞–±–ª–∏—Ü –¥–∏–Ω–∞–º–∏–∫–∏ —É–±–∏—Ä–∞–µ–º 'cohort' –∏–∑ dimensions
    if 'cohort' in dimensions:
        dimensions = []

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã –¥–∏–Ω–∞–º–∏–∫–∏ LTV –∏ ROI
    result_in_time, roi_in_time = group_by_dimensions(
        result_raw, dimensions + ['dt'], horizon_days
    )

    return (
        result_raw,  # —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
        result_grouped,  # —Ç–∞–±–ª–∏—Ü–∞ LTV
        result_in_time,  # —Ç–∞–±–ª–∏—Ü–∞ –¥–∏–Ω–∞–º–∏–∫–∏ LTV
        roi_grouped,  # —Ç–∞–±–ª–∏—Ü–∞ ROI
        roi_in_time,  # —Ç–∞–±–ª–∏—Ü–∞ –¥–∏–Ω–∞–º–∏–∫–∏ ROI
    ) 
```

#### –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è —Ñ—Ä–µ–π–º–∞

def filter_data(df, window):
    # –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ
    for column in df.columns.values:
        df[column] = df[column].rolling(window).mean() 
    return df 
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è

def plot_retention(retention, retention_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(15, 10))

    # –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –∏ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è
    retention = retention.drop(columns=['cohort_size', 0])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    retention_history = retention_history.drop(columns=['cohort_size'])[
        [horizon - 1]
    ]

    # –µ—Å–ª–∏ –≤ –∏–Ω–¥–µ–∫—Å–∞—Ö —Ç–∞–±–ª–∏—Ü—ã —É–¥–µ—Ä–∂–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ payer,
    # –¥–æ–±–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä–æ–π –ø—Ä–∏–∑–Ω–∞–∫ ‚Äî cohort
    if retention.index.nlevels == 1:
        retention['cohort'] = 'All users'
        retention = retention.reset_index().set_index(['cohort', 'payer'])

    # –≤ —Ç–∞–±–ª–∏—Ü–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ ‚Äî –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞ –∏ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏, —á–µ—Ç—ã—Ä–µ —è—á–µ–π–∫–∏
    # –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∏–º –∫—Ä–∏–≤—ã–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    ax1 = plt.subplot(2, 2, 1)
    retention.query('payer == True').droplevel('payer').T.plot(
        grid=True, ax=ax1
    )
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–£–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤–æ –≤—Ç–æ—Ä–æ–π —è—á–µ–π–∫–µ —Å—Ç—Ä–æ–∏–º –∫—Ä–∏–≤—ã–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö
    # –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –æ—Å—å ‚Äî –æ—Ç –≥—Ä–∞—Ñ–∏–∫–∞ –∏–∑ –ø–µ—Ä–≤–æ–π —è—á–µ–π–∫–∏
    ax2 = plt.subplot(2, 2, 2, sharey=ax1)
    retention.query('payer == False').droplevel('payer').T.plot(
        grid=True, ax=ax2
    )
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–£–¥–µ—Ä–∂–∞–Ω–∏–µ –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤ —Ç—Ä–µ—Ç—å–µ–π —è—á–µ–π–∫–µ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö
    ax3 = plt.subplot(2, 2, 3)
    # –ø–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    columns = [
        name
        for name in retention_history.index.names
        if name not in ['dt', 'payer']
    ]
    # —Ñ–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
    filtered_data = retention_history.query('payer == True').pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax3)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title(
        '–î–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(
            horizon
        )
    )

    # –≤ —á—ë—Ç–≤–µ—Ä—Ç–æ–π —è—á–µ–π–∫–µ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö
    ax4 = plt.subplot(2, 2, 4, sharey=ax3)
    # —Ñ–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
    filtered_data = retention_history.query('payer == False').pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax4)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title(
        '–î–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(
            horizon
        )
    )
    
    plt.tight_layout()
    plt.show() 
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

def plot_conversion(conversion, conversion_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(15, 5))

    # –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
    conversion = conversion.drop(columns=['cohort_size'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    conversion_history = conversion_history.drop(columns=['cohort_size'])[
        [horizon - 1]
    ]

    # –ø–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    ax1 = plt.subplot(1, 2, 1)
    conversion.T.plot(grid=True, ax=ax1)
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    ax2 = plt.subplot(1, 2, 2, sharey=ax1)
    columns = [
        # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
        name for name in conversion_history.index.names if name not in ['dt']
    ]
    filtered_data = conversion_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax2)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    plt.tight_layout()
    plt.show() 
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è —Ñ—Ä–µ–π–º–∞

def filter_data(df, window):
    # –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ
    for column in df.columns.values:
        df[column] = df[column].rolling(window).mean() 
    return df 
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ LTV –∏ ROI

def plot_ltv_roi(ltv, ltv_history, roi, roi_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Å–µ—Ç–∫—É –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(20, 10))

    # –∏–∑ —Ç–∞–±–ª–∏—Ü—ã ltv –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
    ltv = ltv.drop(columns=['cohort_size'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ ltv –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    ltv_history = ltv_history.drop(columns=['cohort_size'])[[horizon - 1]]

    # —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∑–∞–ø–∏—à–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ—Ä–µ–π–º
    cac_history = roi_history[['cac']]

    # –∏–∑ —Ç–∞–±–ª–∏—Ü—ã roi –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –∏ cac
    roi = roi.drop(columns=['cohort_size', 'cac'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ roi –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    roi_history = roi_history.drop(columns=['cohort_size', 'cac'])[
        [horizon - 1]
    ]

    # –ø–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ ltv
    ax1 = plt.subplot(2, 3, 1)
    ltv.T.plot(grid=True, ax=ax1)
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('LTV')

    # –≤—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ ltv
    ax2 = plt.subplot(2, 3, 2, sharey=ax1)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in ltv_history.index.names if name not in ['dt']]
    filtered_data = ltv_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax2)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ LTV –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    # —Ç—Ä–µ—Ç–∏–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ cac
    ax3 = plt.subplot(2, 3, 3, sharey=ax1)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in cac_history.index.names if name not in ['dt']]
    filtered_data = cac_history.pivot_table(
        index='dt', columns=columns, values='cac', aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax3)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # —á–µ—Ç–≤—ë—Ä—Ç—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ roi
    ax4 = plt.subplot(2, 3, 4)
    roi.T.plot(grid=True, ax=ax4)
    plt.axhline(y=1, color='red', linestyle='--', label='–£—Ä–æ–≤–µ–Ω—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏')
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('ROI')

    # –ø—è—Ç—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ roi
    ax5 = plt.subplot(2, 3, 5, sharey=ax4)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in roi_history.index.names if name not in ['dt']]
    filtered_data = roi_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax5)
    plt.axhline(y=1, color='red', linestyle='--', label='–£—Ä–æ–≤–µ–Ω—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏')
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ ROI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    plt.tight_layout()
    plt.show() 
```

**–û–±—â–∏–π –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:**

- **–∑–∞–¥–∞–ª –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

  ‚Äî –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
  
  ‚Äî –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ Retention Rate;
  
  ‚Äî –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏;
  
  ‚Äî –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ LTV.

 
 - **–∑–∞–¥–∞–ª —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:**

   ‚Äî –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö;
   
   ‚Äî –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ Retention Rate;
   
   ‚Äî –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏;
   
   ‚Äî –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ LTV –∏ ROI.

### –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –°–æ—Å—Ç–∞–≤–∏–º –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π


```python
profiles = get_profiles(visits, orders, costs)
profiles.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>first_ts</th>
      <th>channel</th>
      <th>device</th>
      <th>region</th>
      <th>dt</th>
      <th>month</th>
      <th>payer</th>
      <th>acquisition_cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>599326</td>
      <td>2019-05-07 20:58:57</td>
      <td>FaceBoom</td>
      <td>Mac</td>
      <td>United States</td>
      <td>2019-05-07</td>
      <td>2019-05-07 20:58:57</td>
      <td>True</td>
      <td>1.088172</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4919697</td>
      <td>2019-07-09 12:46:07</td>
      <td>FaceBoom</td>
      <td>iPhone</td>
      <td>United States</td>
      <td>2019-07-09</td>
      <td>2019-07-09 12:46:07</td>
      <td>False</td>
      <td>1.107237</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6085896</td>
      <td>2019-10-01 09:58:33</td>
      <td>organic</td>
      <td>iPhone</td>
      <td>France</td>
      <td>2019-10-01</td>
      <td>2019-10-01 09:58:33</td>
      <td>False</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22593348</td>
      <td>2019-08-22 21:35:48</td>
      <td>AdNonSense</td>
      <td>PC</td>
      <td>Germany</td>
      <td>2019-08-22</td>
      <td>2019-08-22 21:35:48</td>
      <td>False</td>
      <td>0.988235</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31989216</td>
      <td>2019-10-02 00:07:44</td>
      <td>YRabbit</td>
      <td>iPhone</td>
      <td>United States</td>
      <td>2019-10-02</td>
      <td>2019-10-02 00:07:44</td>
      <td>False</td>
      <td>0.230769</td>
    </tr>
  </tbody>
</table>
</div>




```python
#–Ω–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

print(profiles['first_ts'].min())
```

    2019-05-01 00:00:41
    


```python
#–Ω–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

print(profiles['first_ts'].max())
```

    2019-10-27 23:59:04
    

**–í—ã–≤–æ–¥**

- –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è 1 –º–∞—è 2019 –≥;
- –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è 27 –æ–∫—Ç—è–±—Ä—è 2019 –≥.

–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ –¢–ó.

#### –í—ã—è—Å–Ω–∏–º, –∏–∑ –∫–∞–∫–∏—Ö —Å—Ç—Ä–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞ –∫–∞–∫—É—é —Å—Ç—Ä–∞–Ω—É –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.


```python
region_buy = profiles.groupby('region').agg({'user_id': 'nunique', 'payer': 'sum'}).sort_values(by = 'user_id', ascending = False)
region_buy['payer_per'] = region_buy['payer'] / region_buy['user_id'] * 100
region_buy.drop('payer', axis = 1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>payer_per</th>
    </tr>
    <tr>
      <th>region</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>United States</th>
      <td>100002</td>
      <td>6.901862</td>
    </tr>
    <tr>
      <th>UK</th>
      <td>17575</td>
      <td>3.982930</td>
    </tr>
    <tr>
      <th>France</th>
      <td>17450</td>
      <td>3.799427</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>14981</td>
      <td>4.111875</td>
    </tr>
  </tbody>
</table>
</div>



**–í—ã–≤–æ–¥**

- –ø–æ–¥–∞–≤–ª—è—é—â–µ–µ —á–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ **United States** 100 —Ç—ã—Å, –∏–∑ –Ω–∏—Ö 6,9% –ø–ª–∞—Ç—è—â–∏—Ö;
- –≤—Ç–æ—Ä–æ–µ –º–µ—Å—Ç–æ —É **UK** - —ç—Ç–æ 17,5 —Ç—ã—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏–∑ –Ω–∏—Ö 4% –ø–ª–∞—Ç—è—â–∏—Ö;
- —Ç—Ä–µ—Ç—å–µ –º–µ—Å—Ç–æ —É **France** - —ç—Ç–æ 17,4 —Ç—ã—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏–∑ –Ω–∏—Ö 3,8% –ø–ª–∞—Ç—è—â–∏—Ö.

#### –£–∑–Ω–∞–µ–º, –∫–∞–∫–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—ã –∏ –∫–∞–∫–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –ø–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.


```python
device_buy = profiles.groupby('device').agg({'user_id': 'nunique', 'payer': 'sum'}).sort_values(by = 'user_id', ascending = False)
device_buy['payer_per'] = device_buy['payer'] / device_buy['user_id'] * 100
device_buy.drop('payer', axis = 1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>payer_per</th>
    </tr>
    <tr>
      <th>device</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>iPhone</th>
      <td>54479</td>
      <td>6.207897</td>
    </tr>
    <tr>
      <th>Android</th>
      <td>35032</td>
      <td>5.851793</td>
    </tr>
    <tr>
      <th>PC</th>
      <td>30455</td>
      <td>5.046790</td>
    </tr>
    <tr>
      <th>Mac</th>
      <td>30042</td>
      <td>6.364423</td>
    </tr>
  </tbody>
</table>
</div>



**–í—ã–≤–æ–¥:**

- –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏—Å–ø–æ–ª—å–∑—É—é—Ç iPhone, –∏–∑ –Ω–∏—Ö 6,2% –ø–ª–∞—Ç—è—â–∏—Ö;
- –ù–∞ –≤—Ç–æ—Ä–æ–º –º–µ—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Android - 35 —Ç—ã—Å. –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏–∑ –Ω–∏—Ö 5,85% –ø–ª–∞—Ç—è—â–∏—Ö.

####  –û–ø—Ä–µ–¥–µ–ª–∏–º —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–∞–Ω–∞–ª—ã, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏—à–ª–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.


```python
channel_buy = profiles.groupby('channel').agg({'user_id': 'nunique', 'payer': 'sum'})
channel_buy['payer_per'] = channel_buy['payer'] / channel_buy['user_id'] * 100
channel_buy.sort_values(by = 'payer', ascending = False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>payer</th>
      <th>payer_per</th>
    </tr>
    <tr>
      <th>channel</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>FaceBoom</th>
      <td>29144</td>
      <td>3557</td>
      <td>12.204914</td>
    </tr>
    <tr>
      <th>TipTop</th>
      <td>19561</td>
      <td>1878</td>
      <td>9.600736</td>
    </tr>
    <tr>
      <th>organic</th>
      <td>56439</td>
      <td>1160</td>
      <td>2.055316</td>
    </tr>
    <tr>
      <th>WahooNetBanner</th>
      <td>8553</td>
      <td>453</td>
      <td>5.296387</td>
    </tr>
    <tr>
      <th>AdNonSense</th>
      <td>3880</td>
      <td>440</td>
      <td>11.340206</td>
    </tr>
    <tr>
      <th>RocketSuperAds</th>
      <td>4448</td>
      <td>352</td>
      <td>7.913669</td>
    </tr>
    <tr>
      <th>LeapBob</th>
      <td>8553</td>
      <td>262</td>
      <td>3.063253</td>
    </tr>
    <tr>
      <th>OppleCreativeMedia</th>
      <td>8605</td>
      <td>233</td>
      <td>2.707728</td>
    </tr>
    <tr>
      <th>lambdaMediaAds</th>
      <td>2149</td>
      <td>225</td>
      <td>10.469986</td>
    </tr>
    <tr>
      <th>YRabbit</th>
      <td>4312</td>
      <td>165</td>
      <td>3.826531</td>
    </tr>
    <tr>
      <th>MediaTornado</th>
      <td>4364</td>
      <td>156</td>
      <td>3.574702</td>
    </tr>
  </tbody>
</table>
</div>



**–í—ã–≤–æ–¥**

–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤—ã—è–≤–∏–ª —Ç–æ–ø-3 —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

- **FaceBoom**, 3,5 —Ç—ã—Å –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ 29 —Ç—ã—Å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–Ω—ã—Ö;
- **TipTop** - 1,8 —Ç—ã—Å –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ 19,5 —Ç—ã—Å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–Ω—ã—Ö;
- **organic** - 1,1 —Ç—ã—Å –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ 56 —Ç—ã—Å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–Ω—ã—Ö.

### –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥

#### –í—ã—á–∏—Å–ª–∏–º –æ–±—â—É—é —Å—É–º–º—É —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥.


```python
costs['costs'].sum()
```




    105497.30000000002



**–í—ã–≤–æ–¥:**

–ë—é–¥–∂–µ—Ç –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ —Å–æ—Å—Ç–∞–≤–∏–ª 105 497 —É.–µ.

#### –†–∞—Å—á–∏—Ç–∞–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Å, —Ç–æ –µ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–∏–º —Å–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏ –Ω–∞ –∫–∞–∂–¥—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫


```python
costs.groupby('channel').agg({'costs':'sum'}).sort_values(by='costs', ascending = False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>costs</th>
    </tr>
    <tr>
      <th>channel</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TipTop</th>
      <td>54751.30</td>
    </tr>
    <tr>
      <th>FaceBoom</th>
      <td>32445.60</td>
    </tr>
    <tr>
      <th>WahooNetBanner</th>
      <td>5151.00</td>
    </tr>
    <tr>
      <th>AdNonSense</th>
      <td>3911.25</td>
    </tr>
    <tr>
      <th>OppleCreativeMedia</th>
      <td>2151.25</td>
    </tr>
    <tr>
      <th>RocketSuperAds</th>
      <td>1833.00</td>
    </tr>
    <tr>
      <th>LeapBob</th>
      <td>1797.60</td>
    </tr>
    <tr>
      <th>lambdaMediaAds</th>
      <td>1557.60</td>
    </tr>
    <tr>
      <th>MediaTornado</th>
      <td>954.48</td>
    </tr>
    <tr>
      <th>YRabbit</th>
      <td>944.22</td>
    </tr>
  </tbody>
</table>
</div>



**–í—ã–≤–æ–¥:**

–†–∞—Å—á–µ—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –¥–≤–∞ –∫–∞–Ω–∞–ª–∞ - **TipTop** –∏ **FaceBoom**, –∞–∫–∫–æ–º—É–ª–∏—Ä—É—é—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤. –ò—Ö –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–∞–∑—ã –±–æ–ª—å—à–µ, —á–µ–º —É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ —ç—Ç–æ 2 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.

#### –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∏–Ω–∞–º–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ –Ω–µ–¥–µ–ª—è–º –∏ –º–µ—Å—è—Ü–∞–º) –ø–æ –∫–∞–∂–¥–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É.


```python
# –¥–æ–±–∞–≤–∏–º —Å—Ç–æ–ª–±—Ü—ã —Å –Ω–æ–º–µ—Ä–æ–º –Ω–µ–¥–µ–ª–∏ –∏ –º–µ—Å—è—Ü–∞

costs['week'] = costs['dt'].dt.isocalendar().week
costs['month'] = costs['dt'].dt.month
```


```python
# —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏

plt.figure(figsize=(20, 10))
costs.pivot_table(index = 'week', columns = 'channel', values = 'costs', aggfunc = 'sum').plot(grid = True, ax = plt.subplot(1, 2, 1))
plt.xlabel('–ù–µ–¥–µ–ª—è')
plt.ylabel('–ó–∞—Ç—Ä–∞—Ç—ã')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –Ω–µ–¥–µ–ª—è–º')

costs.pivot_table(index = 'month', columns = 'channel', values = 'costs', aggfunc = 'sum').plot(grid = True, ax = plt.subplot(1, 2, 2))
plt.xlabel('–ú–µ—Å—è—Ü')
plt.ylabel('–ó–∞—Ç—Ä–∞—Ç—ã')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º')
plt.show()
```


    
![png](output_80_0.png)
    


**–í—ã–≤–æ–¥**

1. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –∑–¥–µ—Å—å —Ç–∞–∫–∂–µ –≤—ã–±–∏–≤–∞—é—Ç—Å—è **TipTop**, **FaceBoom**. –ù–∏—á–µ–≥–æ —Å—Ç—Ä–∞–Ω–Ω–æ–≥–æ, –º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –º–Ω–æ–≥–æ –∑–∞—Ç—Ä–∞—Ç.
2. –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É **TipTop** –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–∞—Å—Ç–∏ –≤ 21 –Ω–µ–¥–µ–ª–∏ –∏ –¥–æ—Å—Ç–∏–≥–∞—é—Ç –º–∞–∫—Å–∏–º—É–º–∞ –Ω–∞ 38 –Ω–µ–¥–µ–ª—é, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∏ –≥—Ä–∞—Ñ–∏–∫ –ø–æ –º–µ—Å—è—Ü–∞–º.
3. –ò—Å—Ç–æ—á–Ω–∏–∫ **FaceBoom** —Ç–∞–∫–∂–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–æ—Å—Ç —Å 21 –Ω–µ–¥–µ–ª–∏, –∏ –≤—ã—Ö–æ–¥–∏—Ç –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫ 38 –Ω–µ–¥–µ–ª–µ —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–æ–º–∞–Ω–∏–∏.

####  –†–∞—Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω—é—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (CAC) –∏–∑ –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.


```python
profiles.pivot_table(
    index='dt', columns='channel', values='acquisition_cost', aggfunc='mean'
).plot(grid=True, figsize=(12, 5))
plt.ylabel('CAC, —É.–µ')
plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –°–ê–° –ø–æ –∫–∞–Ω–∞–ª–∞–º –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
plt.show()
```


    
![png](output_84_0.png)
    



```python
cac_by_channel = pd.DataFrame()

# —É–±–µ—Ä—ë–º –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

profiles = profiles.query('channel != "organic"')
cac_by_channel['acquisition_cost_mean'] = profiles.groupby('channel')['acquisition_cost'].mean()
cac_by_channel.sort_values(by='acquisition_cost_mean', ascending=False).style.format({'acquisition_cost_mean': '{:.2f}'})
```




<style type="text/css">
</style>
<table id="T_7c676">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_7c676_level0_col0" class="col_heading level0 col0" >acquisition_cost_mean</th>
    </tr>
    <tr>
      <th class="index_name level0" >channel</th>
      <th class="blank col0" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_7c676_level0_row0" class="row_heading level0 row0" >TipTop</th>
      <td id="T_7c676_row0_col0" class="data row0 col0" >2.80</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row1" class="row_heading level0 row1" >FaceBoom</th>
      <td id="T_7c676_row1_col0" class="data row1 col0" >1.11</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row2" class="row_heading level0 row2" >AdNonSense</th>
      <td id="T_7c676_row2_col0" class="data row2 col0" >1.01</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row3" class="row_heading level0 row3" >lambdaMediaAds</th>
      <td id="T_7c676_row3_col0" class="data row3 col0" >0.72</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row4" class="row_heading level0 row4" >WahooNetBanner</th>
      <td id="T_7c676_row4_col0" class="data row4 col0" >0.60</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row5" class="row_heading level0 row5" >RocketSuperAds</th>
      <td id="T_7c676_row5_col0" class="data row5 col0" >0.41</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row6" class="row_heading level0 row6" >OppleCreativeMedia</th>
      <td id="T_7c676_row6_col0" class="data row6 col0" >0.25</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row7" class="row_heading level0 row7" >YRabbit</th>
      <td id="T_7c676_row7_col0" class="data row7 col0" >0.22</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row8" class="row_heading level0 row8" >MediaTornado</th>
      <td id="T_7c676_row8_col0" class="data row8 col0" >0.22</td>
    </tr>
    <tr>
      <th id="T_7c676_level0_row9" class="row_heading level0 row9" >LeapBob</th>
      <td id="T_7c676_row9_col0" class="data row9 col0" >0.21</td>
    </tr>
  </tbody>
</table>




**–í—ã–≤–æ–¥**

1. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ CAC –ø–æ –∫–∞–Ω–∞–ª—É **TipTop** - —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã—Ä–æ—Å–ª–∞ –≤ 3,5 —Ä–∞–∑–∞ –∑–∞ 5 –º–µ—Å—è—Ü–µ–≤
2. –°–∞–º—ã–º–∏ –¥–æ—Ä–æ–≥–∏–º–∏ –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è –æ–∫–∞–∑–∞–ª–∏—Å—å –∫–∞–Ω–∞–ª—ã:
  - **TipTop** - 2.8 —É.–µ.; 
  - **FaceBoom** - 1.11 —É.–µ.; 
  - **AdNonSense** - 1.01 —É.–µ.



### –û—Ü–µ–Ω–∏–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã

#### –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã c –ø–æ–º–æ—â—å—é –≥—Ä–∞—Ñ–∏–∫–æ–≤ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.


```python
# –∑–∞–¥–∞–¥–∏–º –º–æ–º–µ–Ω—Ç –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞, —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó

observation_date = datetime(2019, 11, 1).date()  # –º–æ–º–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞
horizon_days = 14  # –≥–æ—Ä–∏–∑–æ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞ 

# –∏—Å–∫–ª—é—á–∏–º –∫–∞–Ω–∞–ª organic, —Ç–∞–∫ –∫–∞–∫ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏—Ö –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è 0

profiles = profiles.query('channel != "organic"')
```


```python
# —Å—á–∏—Ç–∞–µ–º LTV –∏ ROI
ltv_raw, ltv_grouped, ltv_history, roi_grouped, roi_history = get_ltv(
    profiles, orders, observation_date, horizon_days
)

# —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏
plot_ltv_roi(ltv_grouped, ltv_history, roi_grouped, roi_history, horizon_days) 
```


    
![png](output_91_0.png)
    


**–ü–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–ª–µ–¥—É—é—â–µ–µ:**

- –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ —è–≤–Ω–æ –≤–∏–¥–∏–º, —á—Ç–æ —Ä–µ–∫–ª–∞–º–∞ –Ω–µ –æ–∫—É–ø–∞–µ—Ç—Å—è (ROI –Ω–∏–∂–µ –µ–¥–∏–Ω–∏—Ü—ã).

- LTV –≤ –∫–æ–º–ø–∞–Ω–∏—è—Ö, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞—Å—Ç–µ—Ç. –ï—Å–ª–∏ –±—ã –º—ã —É–≤–∏–¥–µ–ª–∏ –ø–∞–¥–µ–Ω–∏–µ, —ç—Ç–æ –±—ã –æ–∑–Ω–∞—á–∞–ª–æ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–∫–∏ –≤ 
  —Ä–∞—Å—á–µ—Ç–∞—Ö. –ù–æ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ LTV —Å—Ç–∞–±–∏–ª–µ–Ω.

- –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (CAC) —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞–ª–∞—Å—å; –æ–Ω–∞ –æ–∫—É–ø–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –≤ –º–∞–µ-–∏—é–Ω–µ. CAC –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫–æ–π 
  —É–≥–æ–¥–Ω–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–∞—è —Ü–µ–Ω–∞ —Ä–µ–∫–ª–∞–º—ã –±—ã–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.

#### –ü—Ä–æ–≤–µ—Ä–∏–º –∫–æ–Ω–≤–µ—Ä—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –¥–∏–Ω–∞–º–∏–∫—É –µ—ë –∏–∑–º–µ–Ω–µ–Ω–∏—è, —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–∏–Ω–∞–º–∏–∫—É –µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏ –¥–∏–Ω–∞–º–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
conversion_raw, conversion_grouped, conversion_history = get_conversion(
    profiles, orders, observation_date, horizon_days
)

plot_conversion(conversion_grouped, conversion_history, horizon_days) 
```


    
![png](output_95_0.png)
    



```python
# —Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω–≤–µ—Ä—Å–∏—é —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
dimensions = ['device']

conversion_raw, conversion_grouped, conversion_history = get_conversion(profiles, orders, observation_date, \
                                                                        horizon_days, dimensions=dimensions)

plot_conversion(conversion_grouped, conversion_history, horizon_days)

```


    
![png](output_96_0.png)
    



```python
# —Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω–≤–µ—Ä—Å–∏—é —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º

dimensions = ['region']

conversion_raw, conversion_grouped, conversion_history = get_conversion(profiles, orders, observation_date, \
                                                                        horizon_days, dimensions=dimensions)

plot_conversion(conversion_grouped, conversion_history, horizon_days)
```


    
![png](output_97_0.png)
    



```python
# —Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω–≤–µ—Ä—Å–∏—é —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º

dimensions = ['channel']

conversion_raw, conversion_grouped, conversion_history = get_conversion(profiles, orders, observation_date, \
                                                                        horizon_days, dimensions=dimensions)

plot_conversion(conversion_grouped, conversion_history, horizon_days)
```


    
![png](output_98_0.png)
    


**–í—ã–≤–æ–¥**

1. –û–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Ä–æ—Å—Ç–∞.
2. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–π –≤ —Ä–∞–∑—Ä–µ–∑–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç, –ø—Ä–∏—á–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ **PC** –∑–∞–º–µ–Ω—Ç–Ω–æ –æ—Å—Ç–∞—é—Ç –æ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤. –í –ª–∏–¥–µ—Ä–∞—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫–æ–º–ø–∞–Ω–∏–∏ **Apple**.
3. –†–∞—Å—á–µ—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º –≤—ã—è–≤–∏–ª –ª–∏–¥–∏—Ä—É—é—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –°–®–ê, —ç—Ç–æ –º–æ–∂–Ω–æ –æ–±—å—è—Å–Ω–∏—Ç—å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∫–æ–º–ø–∞–Ω–∏–∏ **Apple**.
4. –ù–∞–∏–±–æ–ª–µ–µ —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —É —Å–ª–µ–¥—É—é—â–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π **FaceBoom**, **TipTop**  ,  –≤ —Å–≤—è–∑–∏ —Å —Ä–∞–±–æ—Ç–æ–π —ç—Ç–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –°–®–ê. **AdNonSense** - –ª–∏–¥–µ—Ä–∞ –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –ï–≤—Ä–æ–ø—ã –∏ –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏–∏.


```python
# –∏—Å—Å–ª–µ–¥—É–µ–º —É–¥–µ—Ä–∂–∞–Ω–∏–µ

retention_raw, retention_grouped, retention_history = get_retention(
    profiles, visits, observation_date, horizon_days
)

plot_retention(retention_grouped, retention_history, horizon_days) 
```


    
![png](output_101_0.png)
    



```python
# –∏—Å—Å–ª–µ–¥—É–µ–º —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

dimensions = ['device']

retention_raw, retention_grouped, retention_history = get_retention(
    profiles, visits, observation_date, horizon_days, dimensions = dimensions
)

plot_retention(retention_grouped, retention_history, horizon_days) 
```


    
![png](output_102_0.png)
    



```python
# –∏—Å—Å–ª–µ–¥—É–µ–º —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º

dimensions = ['region']

retention_raw, retention_grouped, retention_history = get_retention(
    profiles, visits, observation_date, horizon_days, dimensions = dimensions
)

plot_retention(retention_grouped, retention_history, horizon_days) 
```


    
![png](output_103_0.png)
    



```python
# –∏—Å—Å–ª–µ–¥—É–µ–º —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º

dimensions = ['channel']

retention_raw, retention_grouped, retention_history = get_retention(
    profiles, visits, observation_date, horizon_days, dimensions = dimensions
)

plot_retention(retention_grouped, retention_history, horizon_days) 
```


    
![png](output_104_0.png)
    


**–í—ã–≤–æ–¥:**

1. –ù–µ–ø–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–ª–æ—Ö–æ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è. –í –ø—Ä–∏–Ω—Ü–∏–ø–µ, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –∏–º –Ω–µ—á–µ–≥–æ —Ç–µ—Ä—è—Ç—å.
2. –ü–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∑–∞–º–µ—Ç–Ω–æ –ª—É—á—à–µ.
3. –£–¥–µ—Ä–∂–∞–Ω–∏–µ –≤ —Ä–∞–∑—Ä–µ–∑–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç **PC**, **Android**. –≠—Ç–æ –Ω–µ–æ–∂—Ç–¥–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–∞–∫ –∫–∞–∫, –Ω–∞ –ø—Ä–∏–≤–ª—á–µ–Ω–∏–µ —ç—Ç–∏—Ö –ø–æ–ª—å–∑–æ–≤—Ç–∞–ª–µ–π —Ç–∞—Ä—Ç–∏—Ç—å—Å—è –º–µ–Ω—å—à–µ —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ **Apple**.
4. –ü–æ —É–¥–µ—Ä–∂–∞–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–∞–∑—Ä–µ–∑–µ —Ä–µ–≥–∏–æ–Ω–æ–≤ –ø—Ä–æ–∏—à—Ä—ã–≤–∞–µ—Ç –°–®–ê, –Ω–µ —Å–º–æ—Ç—Ä—è –Ω–∞ –±–æ–ª—å—à–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ä–µ–∫–ª–∞–º—É.
5. –ê—É—Ç—Å–∞–π–¥–µ—Ä–∞–º–∏ –ø–æ —É–¥–µ—Ä–∂–∞–Ω–∏—é –≤ —Ä–∞–∑—Ä–µ–∑–µ –∫–∞–Ω–∞–ª–æ–≤ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–π —è–≤–ª—è—é—Ç—Å—è **AdNonSense**, **FaceBoom**.  

#### –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.


```python
# —Å–º–æ—Ç—Ä–∏–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

dimensions = ['device']

ltv_raw, ltv_grouped, ltv_history, roi_grouped, roi_history = get_ltv(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_ltv_roi(
    ltv_grouped, ltv_history, roi_grouped, roi_history, horizon_days, window=14
) 
```


    
![png](output_108_0.png)
    


**–í—ã–≤–æ–¥:**

1. –í —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏, –ª–∏–¥–µ—Ä–∞–º–∏ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é LTV, –∏–ª–∏ Lifetime Value —è–≤–ª—è–µ—Ç—Å—è —É—Å—Ç—Ä–æ–π—Ç–≤–∞ –∫–æ–º–ø–∞–Ω–∏–∏ **Apple**, –∏–∑ –æ–±—â–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã–±–∏–≤–∞—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ **PC**. 
2. –î–∏–Ω–∞–º–∏–∫–∞ ROI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ 14-–π –¥–µ–Ω—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏–µ —É –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ **PC** –æ–∫—É–ø–∞—é—Ç –≤–ª–æ–æ–∂–µ–Ω–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏–± –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ **iPhone** –∏ **Mac** –Ω–µ –æ–∫—É–ø–∞—é—Ç—Å—è –∑–∞ 2 –Ω–µ–¥–µ–ª–∏. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –¥–µ–ª–æ –≤ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —ç—Ç–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤(–æ–Ω–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ, —á–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

#### –û–ø—Ä–µ–¥–µ–ª–∏–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º.


```python
# —Å–º–æ—Ç—Ä–∏–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º

dimensions = ['region']

ltv_raw, ltv_grouped, ltv_history, roi_grouped, roi_history = get_ltv(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_ltv_roi(
    ltv_grouped, ltv_history, roi_grouped, roi_history, horizon_days, window=14
) 

```


    
![png](output_112_0.png)
    


**–í—ã–≤–æ–¥**

1. LTV –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ **United States** –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω –∏ –¥–æ—Å—Ç–∏–≥–∞—é—Ç –µ–¥–∏–Ω–∏—Ü—ã.
2. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ **United States**, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –º–∞—Å—Å—É 100 —Ç—ã—Å —á–µ–ª–æ–≤–µ–∫, –æ–±—Ö–æ–¥—è—Ç—Å—è –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ. –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ **United States** –≤ 4 —Ä–∞–∑–∞ –¥–æ—Ä–æ–∂–µ(–≤ –æ–∫—Ç—è–±—Ä–µ), —á–µ–º –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω.
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ **United States** –Ω–µ –æ–∫—É–ø–∞—é—Ç—Å—è –∑–∞ 2 –Ω–µ–¥–µ–ª–∏, –∫ –∫–æ–Ω—Ü—É 14 –¥–Ω—è –∏—Ö –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å –≤—Å–µ–≥–æ –æ–∫–æ–ª–æ 60%
4. –ì—Ä–∞—Ñ–∏–∫ –¥–∏–Ω–∞–º–∏–∫–∏ ROI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–ø–ª–µ—Å–∫–∏ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ –ò—é–ª–µ –∏ –ê–≤–≥—É—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π **UK**. –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ ROI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π **UK** –≤ –ê–≤–≥—É—Å—Ç–µ —è–≤–ª—è—é—Ç—Å—è —Ä–µ–∫–æ—Ä–¥–Ω—ã–º–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è. 

#### –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –∫–∞–Ω–∞–ª–∞–º.


```python
# —Å–º–æ—Ç—Ä–∏–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è

dimensions = ['channel']

ltv_raw, ltv_grouped, ltv_history, roi_grouped, roi_history = get_ltv(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_ltv_roi(
    ltv_grouped, ltv_history, roi_grouped, roi_history, horizon_days, window=14
)
```


    
![png](output_116_0.png)
    


**–í—ã–≤–æ–¥**

1. –†–∞—Å—á–µ—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ LTV —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ **lambdaMediaAd**, **TipTop** —Ä–∞—Å—Ç—É—Ç –∏ –ø—Ä–µ–≤—ã—à–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –Ω–æ —Å —É—á–µ—Ç–æ–º —Ä–æ—Å—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  **TipTop** –≤—ã—è–≤–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–º —Å—Ä–µ–¥—Å—Ç–≤–∞–º.
2. –†–∞—Å—á–µ—Ç—ã –¥–∏–Ω–∞–º–∏–∫–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–∑—Ä—ã–≤–Ω–æ–π —Ä–æ—Å—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –∫–∞–Ω–∞–ª **TipTop**. –û—Å—Ç–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ "—Ä–æ–≤–Ω—ã–π" —É—Ä–æ–≤–µ–Ω—å —Ä–∞—Å—Ö–æ–¥–æ–≤. 
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–∏—à–µ–¥—à–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ **TipTop**, **FaceBoom** –∏ **AdNonSence** –Ω–µ –æ–∫—É–ø–∞—é—Ç—Å—è –∑–∞ 14 –¥–Ω–µ–π.
4. –î–∏–Ω–∞–º–∏–∫–∞ ROI –ø–æ–ª—å–æ–∑–≤–∞—Ç–µ–ª–µ–π –Ω–∞ 14-–π –¥–µ–Ω—å **YRabbit** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–ø–ª–µ—Å–∫ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –ª–µ—Ç–∞, —á—Ç–æ –º–æ–∂–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å –æ –Ω–∞–ª–∏—á–∏–∏ —Å–µ–∑–æ–Ω–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.	

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**

1. –í —Ü–µ–ª–æ–º —Ä–µ–∫–ª–∞–º–∞ –Ω–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –æ–∫—É–ø–∞–µ—Ç—Å—è.
2. –ù–µ–≥–∞—Ç–∏–≤–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã –æ–∫–∞–∑—ã–≤–∞—é—Ç:

  - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ **United States** (–æ—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π), –æ–Ω–∏ –æ–±—Ö–æ–¥—è—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–æ—Ä–æ–∂–µ, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ 
    –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω. –ö–∞–∫ –∏—Ç–æ–≥, –æ–Ω–∏ –Ω–µ –æ–∫—É–ø–∞—é—Ç—Å—è;
  - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑—É—é—Ç—Å—è **iPhone** (–æ—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –∏ **Mac** –æ–±—Ö–æ–¥—è—Ç—Å—è –¥–æ—Ä–æ–∂–µ, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ 
    –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤;
  - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø—Ä–∏—à–µ–¥—à–∏–µ –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ **TipTop**, **FaceBoom** –∏ **AdNonSence** –Ω–µ –æ–∫—É–ø–∞—é—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –∏—Ö –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ—Ä–æ–∂–µ 
    –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.
3. –ü—Ä–æ–±–ª–µ–º—ã –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –≤—ã–∑–≤–∞–Ω—ã —Ç–µ–º, —á—Ç–æ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–∞—Å—Å, –æ–±—Ö–æ–¥—è—Ç—Å—è —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ.

### –í—ã–≤–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

####  –í—ã–¥–µ–ª–∏–º –ø—Ä–∏—á–∏–Ω—ã –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–ö–æ–º–ø–∞–Ω–∏—è-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Procrastinate Pro+ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç —Å–≤–æ—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –°–®–ê, –ï–≤—Ä–æ–ø—ã (–§—Ä–∞–Ω—Ü–∏—è, –ì–µ—Ä–º–∞–Ω–∏—è), –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏–∏. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–∫–ª–∞–º–Ω—ã–π –±—é–¥–∂–µ—Ç, –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –±—ã–ª–æ –≤–¥–µ–ª–µ–Ω–æ –æ–∫–æ–ª–æ 106 —Ç—ã—Å. —É.–µ., –∫–æ–º–ø–∞–Ω–∏—è –Ω–µ—Å–µ—Ç —É–±—ã—Ç–∫–∏.

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–∏—Ç—É–∞—Ü–∏–∏ –±—ã–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã –∫–æ–º–ø–∞–Ω–∏–µ–π-–∑–∞–∫–∞–∑—á–∏–∫–æ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å—Ö–æ–≤–∞—Ç–µ–ª—è—Ö, –ø—Ä–∏–≤–ª–µ—á–µ–Ω–Ω—ã—Ö —Å —Å 1 –º–∞—è –ø–æ 27 –æ–∫—Ç—è–±—Ä—è 
2019 –≥–æ–¥–∞ –≤ –≤–∏–¥–µ:
- –ª–æ–≥ —Å–µ—Ä–≤–µ—Ä–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ–± –∏—Ö –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö;
- –≤—ã–≥—Ä—É–∑–∫—É –ø–æ–∫—É–ø–æ–∫ –∑–∞ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥;
- —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã. 

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –±—ã–ª–æ –≤—ã—è–≤–ª–µ–Ω–æ, —á—Ç–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —è–≤–ª—è—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ç—Ä–∞—Ç –Ω–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º —Å–ª–µ–¥—É—é—â–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ **TipTop**, **FaceBoom**,  –≤ –°–®–ê –∏ **AdNonSence** –≤ –ï–≤—Ä–æ–ø–µ (—Ç–æ–ø3 –°–ê–°). –†–∞—Å—á–µ—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —á—Ç–æ:
- –∏–∑ –≤—ã—Å–æ–∫–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —É —ç—Ç–∏—Ö –∫–∞–Ω–∞–ª–æ–≤, –Ω–µ –ø—Ä–æ–∏—Ö–æ–¥–∏—Ç –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å –≤ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (14 –¥–Ω–µ–π); 
- —Ç–∞–∫ –∂–µ, –ø–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ **FaceBoom** –∏ **AdNonSence** –∏–º–µ—é—Ç –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ–µ —É–¥–µ—Ä–∂–∞–Ω–∏–µ;
- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∫–æ–º–ø–∞–Ω–∏–∏ **Apple** –æ–∫–∞–∑–∞–ª–∏—Å—å —Å–∞–º—ã–º–∏ –Ω–µ–ø–ª–∞—Ç—è—â–∏–º–∏, –≤–æ–∑–º–æ–∂–Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Procrastinate Pro+ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π ios.
- –∫–∞–Ω–∞–ª –ø–æ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π **TipTop** –æ–∫–∞–∑–∞–ª—Å—è —Å–∞–º—ã–º –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ä–æ—Å—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –Ω–µ–≥–æ –≤  –∑–∞ –∏—Å—Å–µ–¥—É–µ–º—ã–π –ø–µ—Ä–∏–æ–¥ –ø–æ—á—Ç–∏ –≤ —Ç—Ä–∏ —Ä–∞–∑–∞;
- –ø—Ä–æ–∏–∑–æ—à–ª–æ –Ω–µ–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–æ–µ —Å–æ–±—ã—Ç–∏–µ –≤ –°–®–ê, –∫–æ—Ç–æ—Ä–æ–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∑–∏–ª–æ –Ω–µ —Ç–æ–ª—å–∫–æ —É—Ä–æ–≤–µ–Ω—å ROI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–æ –∏ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –ø–æ–≤—ã—Å–∏–ª–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∂–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω—ã. 



#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–¥–µ–ª–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏.

1. –ù—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –Ω–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Å—Ç—Ä–∞–Ω: **UK** –∏ **Germany**.
2. –ü—Ä–∏–≤–ª–µ–∫–∞—Ç—å –±–æ–ª—å—à–µ **PC** –∏ **Android** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –ø—Ä–∏—á–∏–Ω–µ –±–æ–ª–µ–µ —Å–¥–µ—Ä–∂–∞–Ω–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ª—É—á—à–∏–π –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π.
3. –°—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ 3 –Ω–µ–¥–æ–æ—Ü–µ–Ω—ë–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–∞ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º ROI: **Yrabbit**, **MediaTornado**, **lambdaMediaAds**. –î–∞–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ 2.5, —Ö–æ—Ä–æ—à–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ LTV  —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤.
4. –ö–∞–Ω–∞–ª –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π **RocketSuperAds** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å LTV –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ª–∏–¥–µ—Ä–∞–º —ç—Ç–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è **TipTop** –∏ **AdNonSence**.–ü—Ä–∏ —ç—Ç–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—è—Ç–µ—Ä–∫–µ –ª—É—á—à–∏—Ö –ø–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º ROI –æ–∫–æ–ª–æ 2,5 –µ–¥–∏–Ω–∏—Ü—ã. –ö—Ä–æ–º–µ —ç—Ç–æ–≥–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±—Ç–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–ª–µ–π –∑–∞ –∏—Å—Å–ª–µ–¥—É–µ–º—ã–π –ø–µ—Ä–∏–æ–¥. –ü–æ–¥–≤–æ–¥—è –∏—Ç–æ–≥ —Å–∫–∞–∑–∞–Ω–Ω—É–º—É –∫–∞–Ω–∞–ª **RocketSuperAds** —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–∏–º –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ —Ä–∞—Å–∫—Ä—ã—Ç—ã–º –∏—Å—Ç–æ–Ω–∏–∫–æ–º –ø—Ä–∏–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
5. –ü–ª–∞—Ç—è—â–∏–µ PC –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ, –Ω–æ –∫–æ–Ω–≤–µ—Ä—Å–∏—è —Å–∞–º–∞—è –Ω–∏–∑–∫–∞—è. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –µ—Å—Ç—å, –Ω—É–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–∞–º—É —Ä–µ–∫–ª–∞–º—É.
6. –°–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π LTV —É –∫–∞–Ω–∞–ª–∞ **lambdaMediaAds**. –ü–ª–∞—Ç—è—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —è–≤–Ω–æ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø—Ä–æ–¥—É–∫—Ç, –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞–π—Ç–∏ –ø–æ–¥–µ—à–µ–≤–ª–µ –∫–∞–Ω–∞–ª –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –¥–ª—è —ç—Ç–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å ROI.

